const { exec } = require('child_process')

async function runCommandAndCheckForKeyword(npcapPath) {
  return new Promise((resolve, reject) => {
    exec('cmd.exe /c  dir "C:\\Program Files\\Npcap" /AD', (error, stdout, stderr) => {
      if (error) {
        exec(npcapPath, (error, stdout, stderr) => {
          if (error) {
            resolve("File Not Found")
            return
          }
          else if (stderr) {
            resolve("File Not Found")
            return
          }
          resolve("Npcap Installed")
        })
      } else {
        resolve()
      }
    })
  })
}

export default runCommandAndCheckForKeyword
