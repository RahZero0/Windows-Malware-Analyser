import { readdir, unlinkSync } from 'fs'
import { join } from 'node:path'

const rm = async (dirpath) => {
  const searchStrings = [
    '.pcap_Flow.csv',
    '.pcap',
    'predictions.csv',
    '.raw',
    '.mem',
    '.json',
    '.txt',
    '.cache'
  ] // The string at the end of the file names
  readdir(dirpath, (err, files) => {
    if (err) {
      console.error('Error reading directory:', err)
      return
    }
    files.forEach((file) => {
      if (searchStrings.some((searchString) => file.endsWith(searchString))) {
        const filePath = join(dirpath, file)
        try {
          unlinkSync(filePath)
        } catch (unlinkError) {
          console.error(`Error removing file "${file}":`, unlinkError.message)
        }
      }
    })
  })
}

export default rm
