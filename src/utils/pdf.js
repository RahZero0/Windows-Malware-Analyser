import { exec } from 'child_process'
import { join } from 'node:path'
const { app } = require('electron')

// Now you can use `pythonScriptPath` to access your Python script

const plyse = async (pdfpath) => {
  const appPath = app.getAppPath('userData')
  let pythonScriptPath = join(appPath, 'extraResources', 'pdfscan', 'pdf.exe').replace(
    /\\app\.asar\\/g,
    '\\'
  )

  const command = `${pythonScriptPath} ${pdfpath}`
  console.log(command)
  return new Promise((resolve, reject) => {
    exec(command, (error, stdout, stderr) => {
      if (error) {
        console.error(`Error: ${error.message}`)
        reject(error.message)
        return
      }
      if (stderr) {
        console.error(`stderr: ${stderr}`)
        reject(stderr)
        return
      }
      resolve(stdout)
    })
  })
}

export default plyse
